{"ast":null,"code":"import apiService from './api';\nclass BackendAchievementService {\n  constructor() {\n    this.allAchievements = [];\n    this.playerAchievements = [];\n    this.playerStats = {};\n    this.loaded = false;\n  }\n  async loadData(username = 'Jroc_182') {\n    // Changed from 'user'\n    try {\n      const [achievements, playerAchievements, stats] = await Promise.all([apiService.getAllAchievements(), apiService.getPlayerAchievements(username), apiService.getAchievementPlayerStats(username)]);\n      this.allAchievements = achievements;\n      this.playerAchievements = playerAchievements;\n      this.playerStats = stats;\n      this.loaded = true;\n      console.log('✅ Backend achievement data loaded for', username);\n      return {\n        achievements,\n        playerAchievements,\n        stats\n      };\n    } catch (error) {\n      console.error('❌ Failed to load backend achievements:', error);\n      throw error;\n    }\n  }\n  isUnlocked(achievementId) {\n    const playerAchievement = this.playerAchievements.find(pa => pa.achievementId === achievementId || pa.id === achievementId);\n    return (playerAchievement === null || playerAchievement === void 0 ? void 0 : playerAchievement.completed) === true;\n  }\n  getAchievementProgress(achievementId, userStats) {\n    const playerAchievement = this.playerAchievements.find(pa => pa.achievementId === achievementId || pa.id === achievementId // ✅ Check both fields\n    );\n    if (playerAchievement !== null && playerAchievement !== void 0 && playerAchievement.completed) {\n      return 1;\n    }\n\n    // For in-progress achievements, use the progress percentage\n    if (playerAchievement !== null && playerAchievement !== void 0 && playerAchievement.progressPercentage) {\n      return playerAchievement.progressPercentage / 100;\n    }\n\n    // Fallback calculation\n    const progressValue = (playerAchievement === null || playerAchievement === void 0 ? void 0 : playerAchievement.progress) || 0;\n    const maxProgress = (playerAchievement === null || playerAchievement === void 0 ? void 0 : playerAchievement.maxProgress) || 100;\n    return maxProgress > 0 ? progressValue / maxProgress : 0;\n  }\n  getUnlockedAchievements() {\n    const unlockedPlayerAchievements = this.playerAchievements.filter(pa => pa.completed);\n\n    // Merge with full achievement data from allAchievements\n    return unlockedPlayerAchievements.map(playerAch => {\n      const fullAchievement = this.allAchievements.find(a => a.id === playerAch.achievementId || a.id === playerAch.id);\n      if (!fullAchievement) {\n        console.warn(`Full achievement data not found for: ${playerAch.achievementId || playerAch.id}`);\n        return playerAch; // Return as-is if not found\n      }\n      return {\n        ...fullAchievement,\n        // Full achievement data (id, name, description, tier, etc.)\n        ...playerAch,\n        // Player-specific data (progress, completed, unlockedAt)\n        id: fullAchievement.id // Ensure ID is from full achievement\n      };\n    }).filter(Boolean);\n  }\n  getLockedAchievements() {\n    return this.allAchievements.filter(a => !this.isUnlocked(a.id));\n  }\n  getInProgressAchievements() {\n    console.log('🔍 DEBUG: Checking for in-progress achievements...');\n    const filtered = this.playerAchievements.filter(achievement => {\n      const isNotCompleted = !achievement.completed;\n      const hasProgress = (achievement.progressPercentage || 0) > 0;\n      const isNotFullyComplete = (achievement.progressPercentage || 0) < 100;\n      console.log(`🔍 Achievement ${achievement.name}:`, {\n        completed: achievement.completed,\n        progressPercentage: achievement.progressPercentage,\n        isNotCompleted,\n        hasProgress,\n        isNotFullyComplete,\n        willInclude: isNotCompleted && hasProgress && isNotFullyComplete\n      });\n      return isNotCompleted && hasProgress && isNotFullyComplete;\n    });\n    console.log('🔍 Filtered in-progress achievements:', filtered.length);\n    return filtered.map(playerAch => ({\n      ...playerAch,\n      progress: playerAch.progressPercentage || 0,\n      currentProgress: playerAch.progress || 0,\n      targetProgress: playerAch.maxProgress || 100,\n      progressPercentage: playerAch.progressPercentage || 0\n    }));\n  }\n  getStats() {\n    const unlocked = this.getUnlockedAchievements();\n    const total = this.allAchievements.length;\n    return {\n      total,\n      unlocked: unlocked.length,\n      percentage: total > 0 ? Math.round(unlocked.length / total * 100) : 0,\n      totalXP: this.playerStats.totalXp || 0,\n      byTier: {\n        common: unlocked.filter(a => a.tier === 'common').length,\n        uncommon: unlocked.filter(a => a.tier === 'uncommon').length,\n        rare: unlocked.filter(a => a.tier === 'rare').length,\n        legendary: unlocked.filter(a => a.tier === 'legendary').length\n      }\n    };\n  }\n}\nexport default new BackendAchievementService();","map":{"version":3,"names":["apiService","BackendAchievementService","constructor","allAchievements","playerAchievements","playerStats","loaded","loadData","username","achievements","stats","Promise","all","getAllAchievements","getPlayerAchievements","getAchievementPlayerStats","console","log","error","isUnlocked","achievementId","playerAchievement","find","pa","id","completed","getAchievementProgress","userStats","progressPercentage","progressValue","progress","maxProgress","getUnlockedAchievements","unlockedPlayerAchievements","filter","map","playerAch","fullAchievement","a","warn","Boolean","getLockedAchievements","getInProgressAchievements","filtered","achievement","isNotCompleted","hasProgress","isNotFullyComplete","name","willInclude","length","currentProgress","targetProgress","getStats","unlocked","total","percentage","Math","round","totalXP","totalXp","byTier","common","tier","uncommon","rare","legendary"],"sources":["/Users/jenn/Projects/Pixel-Pages/frontend/src/services/backendAchievementService.js"],"sourcesContent":["import apiService from './api';\n\nclass BackendAchievementService {\n  constructor() {\n    this.allAchievements = [];\n    this.playerAchievements = [];\n    this.playerStats = {};\n    this.loaded = false;\n  }\n\n  async loadData(username = 'Jroc_182') {  // Changed from 'user'\n    try {\n      const [achievements, playerAchievements, stats] = await Promise.all([\n        apiService.getAllAchievements(),\n        apiService.getPlayerAchievements(username),\n        apiService.getAchievementPlayerStats(username)\n      ]);\n\n      this.allAchievements = achievements;\n      this.playerAchievements = playerAchievements;\n      this.playerStats = stats;\n      this.loaded = true;\n\n      console.log('✅ Backend achievement data loaded for', username);\n\n      return { achievements, playerAchievements, stats };\n    } catch (error) {\n      console.error('❌ Failed to load backend achievements:', error);\n      throw error;\n    }\n  }\n\n  isUnlocked(achievementId) {\n    const playerAchievement = this.playerAchievements.find(pa => \n      pa.achievementId === achievementId || pa.id === achievementId \n    );\n    return playerAchievement?.completed === true;\n  }\n\n  getAchievementProgress(achievementId, userStats) {\n    const playerAchievement = this.playerAchievements.find(pa => \n      pa.achievementId === achievementId || pa.id === achievementId  // ✅ Check both fields\n    ); \n    \n    if (playerAchievement?.completed) {\n      return 1; \n    }\n    \n    // For in-progress achievements, use the progress percentage\n    if (playerAchievement?.progressPercentage) {\n      return playerAchievement.progressPercentage / 100;\n    }\n    \n    // Fallback calculation\n    const progressValue = playerAchievement?.progress || 0;\n    const maxProgress = playerAchievement?.maxProgress || 100;\n    return maxProgress > 0 ? progressValue / maxProgress : 0;\n  }\n\n  getUnlockedAchievements() {\n    const unlockedPlayerAchievements = this.playerAchievements.filter(pa => pa.completed);\n    \n    // Merge with full achievement data from allAchievements\n    return unlockedPlayerAchievements.map(playerAch => {\n      const fullAchievement = this.allAchievements.find(a => \n        a.id === playerAch.achievementId || a.id === playerAch.id\n      );\n      \n      if (!fullAchievement) {\n        console.warn(`Full achievement data not found for: ${playerAch.achievementId || playerAch.id}`);\n        return playerAch; // Return as-is if not found\n      }\n      \n      return {\n        ...fullAchievement, // Full achievement data (id, name, description, tier, etc.)\n        ...playerAch,       // Player-specific data (progress, completed, unlockedAt)\n        id: fullAchievement.id // Ensure ID is from full achievement\n      };\n    }).filter(Boolean);\n  }\n\n  getLockedAchievements() {\n    return this.allAchievements.filter(a => !this.isUnlocked(a.id));\n  }\n\n  getInProgressAchievements() {\n    console.log('🔍 DEBUG: Checking for in-progress achievements...');\n    \n    const filtered = this.playerAchievements.filter(achievement => {\n      const isNotCompleted = !achievement.completed;\n      const hasProgress = (achievement.progressPercentage || 0) > 0;\n      const isNotFullyComplete = (achievement.progressPercentage || 0) < 100;\n      \n      console.log(`🔍 Achievement ${achievement.name}:`, {\n        completed: achievement.completed,\n        progressPercentage: achievement.progressPercentage,\n        isNotCompleted,\n        hasProgress,\n        isNotFullyComplete,\n        willInclude: isNotCompleted && hasProgress && isNotFullyComplete\n      });\n      \n      return isNotCompleted && hasProgress && isNotFullyComplete;\n    });\n    \n    console.log('🔍 Filtered in-progress achievements:', filtered.length);\n    \n    return filtered.map(playerAch => ({\n      ...playerAch,\n      progress: playerAch.progressPercentage || 0,\n      currentProgress: playerAch.progress || 0,\n      targetProgress: playerAch.maxProgress || 100,\n      progressPercentage: playerAch.progressPercentage || 0\n    }));\n  }\n\n  getStats() {\n    const unlocked = this.getUnlockedAchievements();\n    const total = this.allAchievements.length;\n    \n    return {\n      total,\n      unlocked: unlocked.length,\n      percentage: total > 0 ? Math.round((unlocked.length / total) * 100) : 0,\n      totalXP: this.playerStats.totalXp || 0,\n      byTier: {\n        common: unlocked.filter(a => a.tier === 'common').length,\n        uncommon: unlocked.filter(a => a.tier === 'uncommon').length,\n        rare: unlocked.filter(a => a.tier === 'rare').length,\n        legendary: unlocked.filter(a => a.tier === 'legendary').length\n      }\n    };\n  }\n}\n\nexport default new BackendAchievementService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}